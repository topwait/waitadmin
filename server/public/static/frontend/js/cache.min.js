let waitCache = {
    setItem: function(key, value) {
        try {
            const storage = JSON.parse(window.localStorage.getItem(waitConfig.namespace) || '{}');
            storage[key] = value;
            window.localStorage.setItem(waitConfig.namespace, JSON.stringify(storage));
            return true;
        } catch (e) {
            return false;
        }
    },
    getItem: function(key) {
        const storage = JSON.parse(window.localStorage.getItem(waitConfig.namespace) || '{}');
        if (key) {
            return storage[key] || undefined;
        }
        return storage;
    },
    removeItem: function(key) {
        const storage = JSON.parse(window.localStorage.getItem(waitConfig.namespace) || '{}');
        delete storage[key];
        window.localStorage.setItem(waitConfig.namespace, JSON.stringify(storage));
    },
    set: function(key, value, expire) {
        let data = value;
        if (expire) {
            let time = Math.round(new Date().getTime() / 1000);
            data = {
                expire: time + expire,
                value: value
            }
        }

        if (typeof data === 'object') {
            data = JSON.stringify(data);
        }

        try {
            window.localStorage.setItem(key, data);
            return true;
        } catch (e) {
            return false;
        }
    },
    get: function(key) {
        const data = window.localStorage.getItem(key);
        if (!data) {
            return undefined;
        }

        try {
            let time = Math.round(new Date().getTime() / 1000);
            const { value, expire } = JSON.parse(data);
            if (expire && expire < time) {
                window.localStorage.removeItem(key)
                return undefined;
            }
            return value;
        } catch (e) {
            return data;
        }
    },
    remove: function(key) {
        window.localStorage.removeItem(key);
    },
    clear: function() {
        window.localStorage.clear();
    }
}